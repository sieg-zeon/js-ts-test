# Worker Threads 実装

このディレクトリには、Node.js の Worker Threads を使用した並列処理の実装が含まれており、複数の CPU コアを活用した処理のデモンストレーションを行います。

## 概要

実装は以下の 2 つの主要なファイルで構成されています：

- `main.ts`: ワーカースレッドの作成と管理を行う
- `worker.ts`: ワーカースレッドのロジックを含む

## 動作の仕組み

### メインスレッド (main.ts)

1. **初期化**

   - 利用可能な CPU コア数を検出
   - ファイルパスの設定と必要なモジュールのインポート

2. **ワーカーの作成**

   - CPU コア数に応じたワーカースレッドの作成
   - 各ワーカーに一意の ID を割り当て
   - ワーカーとの通信チャネルの設定

3. **ワーカーの管理**
   - ワーカーからのメッセージの監視
   - エラーの処理
   - ワーカーの終了状態の監視

### ワーカースレッド (worker.ts)

1. **セットアップ**

   - メインスレッドからワーカー ID を受け取る
   - メインスレッドとの通信を確立

2. **処理**

   - CPU 負荷の高い計算を実行
   - 進捗状況をメインスレッドに送信
   - 計算結果を返す

3. **通信**
   - 重要な時点でステータスメッセージを送信：
     - ワーカーの開始
     - 計算の完了
     - ワーカーの終了

## 主な機能

- **並列処理**: 利用可能なすべての CPU コアを活用
- **ノンブロッキング**: メインスレッドの応答性を維持
- **エラーハンドリング**: 包括的なエラー管理
- **ステータス監視**: リアルタイムのワーカーステータス更新

## 使用方法

1. メインスクリプトを実行:

```bash
npm run start worker_threads/main.ts
```

1. システムは以下の処理を行います：
   - CPU コア数に等しい数のワーカースレッドを作成
   - 並列計算を実行
   - 進捗状況と結果を表示

## 利点

- CPU 負荷の高いタスクのパフォーマンス向上
- リソースの効率的な活用
- アプリケーションの応答性の維持
- 異なる CPU 構成へのスケーラビリティ
